SPECIFICATION Spec_RecoverySubsystem

CONSTANTS
    \* From CORE
    MAX_TX = 3
    MAX_LSN = 20
    MAX_PAGES = 3
    
    \* From WAL
    TxIds = {1, 2, 3}
    PageIds = {1, 2, 3}
    Keys = {1, 2}
    Resources = {1, 2}
    
    \* RecoverySubsystem specific
    BACKUP_INTERVAL_LSN = 5
    MAX_ARCHIVED_SEGMENTS = 3
    COMPRESSION_ALGORITHM = "lz4"
    BACKUP_TYPES = {"FULL", "INCREMENTAL"}

INVARIANTS
    TypeOK_RecoverySubsystem
    Inv_RS_Safety
    Inv_RS_Durability
    Inv_RS_WARProtocol
    Inv_RS_BackupCompleteness
    Inv_RS_PITRAccuracy
    Inv_RS_ExclusiveRecovery
    Inv_RS_StateMachineValid
    Inv_RS_ArchivedWALBounded
    Inv_RS_BackupMonotonic

PROPERTIES
    Liveness_RS_RecoveryCompletes
    Liveness_RS_BackupProgress

CONSTRAINT
    nextLSN <= MAX_LSN

