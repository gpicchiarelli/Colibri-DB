SPECIFICATION Spec

CONSTANTS
    Users = {alice, bob, charlie, admin}
    Roles = {user, manager, dba, security_officer, auditor}
    Permissions = {read_table, write_table, delete_table, create_table, grant_perm}
    Objects = {employees, salaries, audit_log}
    Operations = {SELECT, INSERT, UPDATE, DELETE, CREATE, GRANT}
    MaxActiveRoles = 3
    MaxRoleDepth = 5

    * CORE constants (required since module EXTENDS CORE)
    MAX_TX = 3
    MAX_LSN = 20
    MAX_PAGES = 10
    PAGE_SIZE = 1024

INVARIANTS
    TypeInvariant
    UserRolesValid
    RolePermissionsValid
    NoHierarchyCycles
    BoundedHierarchyDepth
    ActiveRoleLimit
    ActiveRolesBelongToUser
    StaticSoDEnforced
    DynamicSoDEnforced
    ActivationCountsAccurate
    AuditLogMonotonic
    LeastPrivilege
    SeparationOfDuty
    HierarchyPreservesPermissions

PROPERTIES
    RoleAssignmentGrantsPermissions
    RolesEventuallyDeactivated

CONSTRAINT
    currentTime < 100

