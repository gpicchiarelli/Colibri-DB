\* TLC Configuration for WAL.tla
\* Model checking parameters for Write-Ahead Logging specification

\* Specification to check
SPECIFICATION Spec

\* Constants
CONSTANTS
  MAX_TX = 3
  MAX_LSN = 20
  MAX_PAGES = 5
  GROUP_COMMIT_THRESHOLD = 3
  GROUP_COMMIT_TIMEOUT_MS = 10
  ModifiablePages = {1, 2, 3}
  PAGE_SIZE = 1024

\* Invariants to check
INVARIANTS
  TypeOK
  Inv_WAL_LogBeforeData
  Inv_WAL_DurabilityInvariant
  Inv_WAL_LogOrderInvariant
  Inv_WAL_PendingConsecutive
  Inv_WAL_CheckpointConsistency
  Inv_WAL_DPTConsistency
  Inv_WAL_Safety

\* Temporal properties to check
\* Note: Liveness requires fairness assumptions
PROPERTIES
  \* Commented out for initial model checking (expensive)
  \* Uncomment to verify liveness:
  \* Liveness_EventualFlush
  \* Liveness_EventualRecovery

\* State space constraints
CONSTRAINT
  \* Limit nextLSN to reduce state space
  nextLSN <= MAX_LSN

\* Symmetry reduction
\* ModifiablePages are symmetric (can be permuted)
SYMMETRY
  Permutations(ModifiablePages)

\* View (for state equivalence)
\* Two states are equivalent if they differ only in permutations of pages
VIEW
  <<wal, flushedLSN, pendingRecords>>

\* Action constraints (for debugging specific scenarios)
\* Uncomment to focus on specific actions:
\* ACTION_CONSTRAINT
\*   \/ Append
\*   \/ Flush
\*   \/ Checkpoint

